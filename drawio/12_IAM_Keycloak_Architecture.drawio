<mxfile host="app.diagrams.net">
  <diagram name="IAM Keycloak Architecture" id="iam-keycloak">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- TITLE -->
        <mxCell id="title" value="IAM & Keycloak Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="400" height="30" as="geometry" />
        </mxCell>
        
        <!-- USER LAYER -->
        <mxCell id="users" value="ðŸ‘¥ USERS & CLIENTS" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1976d2;strokeWidth=2;fontStyle=1;fontSize=12;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="70" width="1300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="customs-broker" value="ðŸ‘¨â€ðŸ’¼ Customs\nBroker" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="50" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="importer" value="ðŸ“¦ Importer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="180" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="customs-officer" value="ðŸ‘®â€â™‚ï¸ Customs\nOfficer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="310" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="inspector" value="ðŸ” Inspector" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="440" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="supervisor" value="ðŸ‘¨â€ðŸ’¼ Supervisor" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="570" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="admin" value="ðŸ‘¨â€ðŸ’» System\nAdmin" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1976d2;strokeWidth=1;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="700" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="api-client" value="ðŸ”Œ API\nClient" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#90caf9;strokeColor=#1976d2;strokeWidth=2;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="830" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="external-systems" value="ðŸŒ External\nSystems" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#90caf9;strokeColor=#1976d2;strokeWidth=2;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="960" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="mobile-app" value="ðŸ“± Mobile\nApp" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#90caf9;strokeColor=#1976d2;strokeWidth=2;fontSize=10;" vertex="1" parent="users">
          <mxGeometry x="1090" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        
        <!-- KEYCLOAK LAYER -->
        <mxCell id="keycloak-layer" value="ðŸ” KEYCLOAK IDENTITY & ACCESS MANAGEMENT" style="swimlane;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontStyle=1;fontSize=12;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="220" width="1300" height="250" as="geometry" />
        </mxCell>
        
        <!-- Authentication -->
        <mxCell id="auth-section" value="ðŸ”‘ AUTHENTICATION" style="swimlane;whiteSpace=wrap;html=1;fillColor=#ffcc80;strokeColor=#e65100;strokeWidth=1;fontStyle=1;fontSize=10;startSize=25;" vertex="1" parent="keycloak-layer">
          <mxGeometry x="20" y="40" width="300" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="login-forms" value="ðŸ–¥ï¸ Login Forms" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="20" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="social-login" value="ðŸ“± Social Login" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="120" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="mfa" value="ðŸ” MFA" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="220" y="30" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="ldap-ad" value="ðŸ¢ LDAP/AD" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="20" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="saml" value="ðŸ”— SAML" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="120" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="openid-connect" value="ðŸ”“ OpenID Connect" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="220" y="80" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="session-mgmt" value="ðŸ• Session Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#e65100;strokeWidth=1;fontSize=9;" vertex="1" parent="auth-section">
          <mxGeometry x="70" y="130" width="120" height="30" as="geometry" />
        </mxCell>
        
        <!-- Authorization -->
        <mxCell id="authz-section" value="ðŸ›¡ï¸ AUTHORIZATION" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#0277bd;strokeWidth=1;fontStyle=1;fontSize=10;startSize=25;" vertex="1" parent="keycloak-layer">
          <mxGeometry x="340" y="40" width="300" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="rbac" value="ðŸ‘¤ RBAC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="20" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="abac" value="ðŸ“‹ ABAC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="120" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="policies" value="ðŸ“œ Policies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="220" y="30" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="permissions" value="âœ… Permissions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="20" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="resources" value="ðŸ—‚ï¸ Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="120" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="scopes" value="ðŸŽ¯ Scopes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="220" y="80" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="uma" value="ðŸ” UMA 2.0" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3e5fc;strokeColor=#0277bd;strokeWidth=1;fontSize=9;" vertex="1" parent="authz-section">
          <mxGeometry x="70" y="130" width="120" height="30" as="geometry" />
        </mxCell>
        
        <!-- Token Management -->
        <mxCell id="token-section" value="ðŸŽ« TOKEN MANAGEMENT" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#2e7d32;strokeWidth=1;fontStyle=1;fontSize=10;startSize=25;" vertex="1" parent="keycloak-layer">
          <mxGeometry x="660" y="40" width="300" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="jwt" value="ðŸŽ« JWT Tokens" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="20" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="access-tokens" value="ðŸ”‘ Access Tokens" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="120" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="refresh-tokens" value="ðŸ”„ Refresh Tokens" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="220" y="30" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="introspection" value="ðŸ” Token Introspection" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="20" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="revocation" value="âŒ Token Revocation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="120" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="validation" value="âœ… Token Validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="220" y="80" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="claims" value="ðŸ“‹ Claims Mapping" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="70" y="130" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="audience" value="ðŸŽ¯ Audience Validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#2e7d32;strokeWidth=1;fontSize=9;" vertex="1" parent="token-section">
          <mxGeometry x="200" y="130" width="80" height="30" as="geometry" />
        </mxCell>
        
        <!-- Core Management -->
        <mxCell id="core-section" value="âš™ï¸ CORE MANAGEMENT" style="swimlane;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#ad1457;strokeWidth=1;fontStyle=1;fontSize=10;startSize=25;" vertex="1" parent="keycloak-layer">
          <mxGeometry x="980" y="40" width="300" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="realms" value="ðŸŒ Realms" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="20" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="clients-mgmt" value="ðŸ”Œ Clients" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="120" y="30" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="users-mgmt" value="ðŸ‘¥ Users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="220" y="30" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="groups" value="ðŸ‘¥ Groups" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="20" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="roles" value="ðŸŽ­ Roles" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="120" y="80" width="80" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="attributes" value="ðŸ“‹ Attributes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="220" y="80" width="60" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="mappers" value="ðŸ”„ Mappers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8bbd9;strokeColor=#ad1457;strokeWidth=1;fontSize=9;" vertex="1" parent="core-section">
          <mxGeometry x="70" y="130" width="120" height="30" as="geometry" />
        </mxCell>
        
        <!-- APPLICATION LAYER -->
        <mxCell id="app-layer" value="ðŸš€ JUL APPLICATIONS" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e8f5e8;strokeColor=#4caf50;strokeWidth=2;fontStyle=1;fontSize=12;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="500" width="1300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="angular-frontend" value="ðŸ…°ï¸ Angular\nFrontend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="50" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="spring-services" value="ðŸƒ Spring Boot\nMicroservices" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="200" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="api-gateway" value="ðŸ¦ Kong\nAPI Gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#81c784;strokeColor=#4caf50;strokeWidth=2;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="350" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="integration-services" value="ðŸ”Œ Integration\nServices" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="500" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="document-service" value="ðŸ“„ Document\nService" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="650" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="notification-service" value="ðŸ“§ Notification\nService" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="800" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="audit-service" value="ðŸ“ Audit\nService" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="950" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="reporting-service" value="ðŸ“Š Reporting\nService" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=#4caf50;strokeWidth=1;fontSize=10;" vertex="1" parent="app-layer">
          <mxGeometry x="1100" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        
        <!-- DATA LAYER -->
        <mxCell id="data-layer" value="ðŸ—ƒï¸ DATA & STORAGE" style="swimlane;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#0277bd;strokeWidth=2;fontStyle=1;fontSize=12;startSize=30;" vertex="1" parent="1">
          <mxGeometry x="50" y="650" width="1300" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="keycloak-db" value="ðŸ—ƒï¸ Keycloak\nPostgreSQL" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#81d4fa;strokeColor=#0277bd;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="100" y="40" width="100" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="jul-db" value="ðŸ—ƒï¸ JUL\nPostgreSQL" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#81d4fa;strokeColor=#0277bd;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="250" y="40" width="100" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="redis-cache" value="âš¡ Redis\nCache" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffb74d;strokeColor=#f57c00;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="400" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="minio-storage" value="ðŸ“¦ MinIO\nObject Storage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#81c784;strokeColor=#388e3c;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="550" y="50" width="120" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="ldap-dir" value="ðŸ“‚ LDAP\nDirectory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ce93d8;strokeColor=#7b1fa2;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="720" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="audit-db" value="ðŸ—ƒï¸ Audit\nDatabase" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#81d4fa;strokeColor=#0277bd;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="870" y="40" width="100" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="backup-storage" value="ðŸ’¾ Backup\nStorage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a5d6a7;strokeColor=#388e3c;strokeWidth=1;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="1020" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="key-vault" value="ðŸ—ï¸ Key\nVault" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcdd2;strokeColor=#c62828;strokeWidth=2;fontSize=10;" vertex="1" parent="data-layer">
          <mxGeometry x="1170" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        
        <!-- AUTHENTICATION FLOWS -->
        <mxCell id="auth-flow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1976d2;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="customs-broker" target="login-forms">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="150" y="200" />
              <mxPoint x="110" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="auth-flow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1976d2;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="api-client" target="openid-connect">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="930" y="200" />
              <mxPoint x="340" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- TOKEN FLOWS -->
        <mxCell id="token-flow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#2e7d32;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="jwt" target="api-gateway">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="740" y="480" />
              <mxPoint x="460" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="token-flow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#2e7d32;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="validation" target="spring-services">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="890" y="480" />
              <mxPoint x="310" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- AUTHORIZATION FLOWS -->
        <mxCell id="authz-flow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0277bd;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="rbac" target="spring-services">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="430" y="480" />
              <mxPoint x="310" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="authz-flow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0277bd;strokeWidth=2;endArrow=classic;" edge="1" parent="1" source="permissions" target="integration-services">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="430" y="480" />
              <mxPoint x="610" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- DATA CONNECTIONS -->
        <mxCell id="data-conn1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0277bd;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="keycloak-layer" target="keycloak-db">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="200" y="480" />
              <mxPoint x="200" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="data-conn2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0277bd;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="spring-services" target="jul-db">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="310" y="630" />
              <mxPoint x="350" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="data-conn3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#f57c00;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="session-mgmt" target="redis-cache">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="180" y="480" />
              <mxPoint x="500" y="480" />
              <mxPoint x="500" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="data-conn4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#388e3c;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="document-service" target="minio-storage">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="760" y="630" />
              <mxPoint x="660" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="data-conn5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#7b1fa2;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="ldap-ad" target="ldap-dir">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="130" y="480" />
              <mxPoint x="820" y="480" />
              <mxPoint x="820" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="data-conn6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#0277bd;strokeWidth=2;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="audit-service" target="audit-db">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="630" />
              <mxPoint x="970" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- SECURITY CONNECTIONS -->
        <mxCell id="sec-conn1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#c62828;strokeWidth=2;strokeStyle=dashed;endArrow=oval;startArrow=oval;" edge="1" parent="1" source="keycloak-layer" target="key-vault">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1300" y="480" />
              <mxPoint x="1270" y="480" />
              <mxPoint x="1270" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="sec-conn2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#388e3c;strokeWidth=1;strokeStyle=dashed;" edge="1" parent="1" source="audit-db" target="backup-storage">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- USER ACCESS PATTERNS -->
        <mxCell id="user-access1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1976d2;strokeWidth=1;strokeStyle=dashed;" edge="1" parent="1" source="importer" target="angular-frontend">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="480" />
              <mxPoint x="160" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="user-access2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1976d2;strokeWidth=1;strokeStyle=dashed;" edge="1" parent="1" source="customs-officer" target="spring-services">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="410" y="480" />
              <mxPoint x="310" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="user-access3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#1976d2;strokeWidth=1;strokeStyle=dashed;" edge="1" parent="1" source="external-systems" target="api-gateway">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="480" />
              <mxPoint x="460" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
        
        <!-- ADMIN ACCESS -->
        <mxCell id="admin-access" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#ad1457;strokeWidth=3;endArrow=classic;" edge="1" parent="1" source="admin" target="core-section">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="200" />
              <mxPoint x="1180" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>