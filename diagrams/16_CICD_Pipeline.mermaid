%%{init: {'theme':'base', 'themeVariables': {'fontSize': '10px', 'fontFamily': 'Arial, sans-serif'}}}%%
graph TD
    %% Developer Workflow
    subgraph Developer["ðŸ‘¨â€ðŸ’» DEVELOPER"]
        Developer1[ðŸ‘¨â€ðŸ’» Developer]
        LocalDev[ðŸ’» Local Development]
        Developer1 --> LocalDev
    end

    %% Source Control
    subgraph SourceControl["ðŸ“š SOURCE CONTROL"]
        GitLab[ðŸ“š GitLab Enterprise]
        MainBranch[ðŸŒŸ main branch]
        DevelopBranch[ðŸ”§ develop branch]
        FeatureBranches[ðŸš€ feature/* branches]
    end

    %% Pipeline Triggers
    subgraph PipelineTriggers["ðŸ”„ TRIGGERS"]
        CommitTrigger[ðŸ“ Code Commit]
        MRTrigger[ðŸ”€ Merge Request]
        TagTrigger[ðŸ·ï¸ Git Tag]
        ScheduledTrigger[â° Scheduled]
    end

    %% CI Pipeline
    subgraph CIPipeline["ðŸ”¨ CI PIPELINE"]
        CheckoutCode[ðŸ“¥ Checkout Code]
        DependencyInstall[ðŸ“¦ Install Dependencies]
        CompileCode[ðŸ”¨ Compile Code]
        UnitTests[ðŸ§ª Unit Tests]
        
        CodeAnalysis[ðŸ” Code Analysis]
        SecurityScan[ðŸ”’ Security Scan]
        IntegrationTests[ðŸ”— Integration Tests]
        
        DockerBuild[ðŸ³ Docker Build]
        ImageScan[ðŸ” Image Scan]
        ImagePush[ðŸ“¤ Push to Registry]
    end

    %% Artifact Repository
    subgraph ArtifactRepo["ðŸ“¦ ARTIFACTS"]
        HarborRegistry[ðŸ³ Harbor Registry]
        HelmRepository[âš™ï¸ Helm Repository]
        NuGetFeed[ðŸ“¦ NuGet Feed]
        NPMRegistry[ðŸ“¦ NPM Registry]
    end

    %% CD Pipeline
    subgraph CDPipeline["ðŸš€ CD PIPELINE"]
        DevDeploy[ðŸŸ¢ Dev Deploy]
        StagingDeploy[ðŸŸ¡ Staging Deploy]
        ProdDeploy[ðŸ”´ Prod Deploy]
        
        BlueGreen[ðŸ”„ Blue-Green]
        RollingUpdate[ðŸ“ˆ Rolling Update]
        CanaryDeploy[ðŸ¤ Canary Deploy]
    end

    %% Kubernetes Environments
    subgraph K8sEnvironments["â˜¸ï¸ KUBERNETES"]
        DevEnvironment[ðŸŸ¢ Development]
        StagingEnvironment[ðŸŸ¡ Staging]
        ProductionEnvironment[ðŸ”´ Production]
    end

    %% Infrastructure as Code
    subgraph IaC["ðŸ—ï¸ INFRASTRUCTURE"]
        TerraformModules[ðŸ—ï¸ Terraform Modules]
        ApplicationCharts[âš™ï¸ Application Charts]
        ConfigMaps[âš™ï¸ ConfigMaps]
        Secrets[ðŸ” Secrets]
    end

    %% Monitoring
    subgraph Monitoring["ðŸ“Š MONITORING"]
        GitLabCI[ðŸ“Š GitLab CI Metrics]
        QualityMetrics[ðŸ“ˆ Quality Metrics]
        DeploymentStatus[ðŸš€ Deployment Status]
        ApplicationMetrics[ðŸ“Š App Metrics]
    end

    %% Security
    subgraph Security["ðŸ”’ SECURITY"]
        SAST[ðŸ” SAST]
        DAST[ðŸ•¸ï¸ DAST]
        DependencyCheck[ðŸ“¦ Dependency Check]
        ContainerScan[ðŸ³ Container Scan]
        PolicyValidation[ðŸ“‹ Policy Validation]
        AuditLogging[ðŸ“ Audit Logging]
    end

    %% Testing Strategy
    subgraph TestingStrategy["ðŸ§ª TESTING"]
        UnitTestLayer[ðŸ§ª Unit Tests 70%]
        IntegrationTestLayer[ðŸ”— Integration Tests 20%]
        E2ETestLayer[ðŸŽ­ E2E Tests 10%]
        TestDataManagement[ðŸ—ƒï¸ Test Data Mgmt]
    end

    %% Release Management
    subgraph ReleaseManagement["ðŸ·ï¸ RELEASE"]
        GitFlow[ðŸŒŠ Git Flow]
        SemanticVersioning[ðŸ”¢ Semantic Versioning]
        ReleaseNotes[ðŸ“ Release Notes]
        RollbackProcedures[â†©ï¸ Rollback Procedures]
    end

    %% Pipeline Flow
    subgraph PipelineFlow["ðŸ”„ PIPELINE FLOW"]
        Step1[1ï¸âƒ£ Code Commit]
        Step2[2ï¸âƒ£ Build & Test]
        Step3[3ï¸âƒ£ Quality Gates]
        Step4[4ï¸âƒ£ Security Scan]
        Step5[5ï¸âƒ£ Package]
        Step6[6ï¸âƒ£ Deploy]
        
        Step1 --> Step2 --> Step3 --> Step4 --> Step5 --> Step6
    end

    %% Main Flow Connections
    Developer --> SourceControl
    SourceControl --> PipelineTriggers
    PipelineTriggers --> CIPipeline
    CIPipeline --> ArtifactRepo
    ArtifactRepo --> CDPipeline
    CDPipeline --> K8sEnvironments
    
    %% Supporting Connections
    IaC --> K8sEnvironments
    Security --> CIPipeline
    TestingStrategy --> CIPipeline
    Monitoring -.-> CIPipeline
    Monitoring -.-> CDPipeline
    ReleaseManagement --> CDPipeline
    PipelineFlow -.-> CIPipeline